"use strict";(self.webpackChunkno_thin_project_landing=self.webpackChunkno_thin_project_landing||[]).push([[353],{9353:(e,t,o)=>{o.r(t),o.d(t,{default:()=>y});var n=o(5043),r=o(9435),i=o(9408);const a=[[{position:new r.Pq0(0,.32,0),rotation:new r.O9p(0,0,0)},{position:new r.Pq0(0,0,0),rotation:new r.O9p(0,0,0)},{position:new r.Pq0(-.15,0,0),rotation:new r.O9p(0,0,r.cj9.degToRad(-20))},{position:new r.Pq0(.15,0,0),rotation:new r.O9p(0,0,r.cj9.degToRad(20))},{position:new r.Pq0(-.11,-.4,0),rotation:new r.O9p(0,0,r.cj9.degToRad(-15))},{position:new r.Pq0(.11,-.4,0),rotation:new r.O9p(0,0,r.cj9.degToRad(15))}]];var s=o(6064),c=o(453),l=o(1053),u=o(9612),d=o(217),p=o(8368),h=o(579);const w={debug:{enable:!1,showDebugCursorCollision:!1,debugCursorColor:16711935,showDebugOBB:!1,showDebugSphere:!1},boundary:{collisionType:"OBB",sphereScale:1},speed:{objectSpeedMultiplier:1,stateLerpSpeed:1},performance:{enablePostProcessing:!1,pixelRatio:1,enableShadows:!1,antialias:!0},constants:{CURSOR_IMPULSE_MULTIPLIER:.05},controls:{enableScrollRotation:!1,toggleKey:"r",enableScrollImpulse:!1,toggleImpulseKey:"i"},camera:{fov:20}};function g(e){e.updateWorldMatrix(!0,!1),e.geometry.computeBoundingBox();const t=e.geometry.boundingBox,o=new r.Pq0;t.getSize(o);const n=o.multiplyScalar(.5),i=new r.Pq0;t.getCenter(i),i.applyMatrix4(e.matrixWorld);const a=new p.W;a.center.copy(i),a.halfSize.copy(n);const s=(new r.dwI).setFromMatrix4(e.matrixWorld);return a.rotation.copy(s),a}function f(e){const t=[];for(let s=0;s<8;s++){const o=1&s?1:-1,n=2&s?1:-1,i=4&s?1:-1,a=new r.Pq0(o*e.halfSize.x,n*e.halfSize.y,i*e.halfSize.z);a.applyMatrix3(e.rotation),a.add(e.center),t.push(a)}const o=[0,1,0,2,0,4,1,3,1,5,2,3,2,6,3,7,4,5,4,6,5,7,6,7],n=new r.LoY,i=new Float32Array(3*o.length);for(let r=0;r<o.length;r++){const e=t[o[r]];i[3*r]=e.x,i[3*r+1]=e.y,i[3*r+2]=e.z}n.setAttribute("position",new r.THS(i,3));const a=new r.mrM({color:65280,depthTest:!1,transparent:!0,opacity:1});return new r.DXC(n,a)}function m(e){const t=2*Math.tan(r.cj9.degToRad(e.fov/2))*Math.abs(e.position.z);return{frustumWidth:t*e.aspect,frustumHeight:t}}const y=(0,n.forwardRef)(((e,t)=>{let{hdrTexture:o,showDebugButtons:p}=e;const y=(0,n.useRef)(null),b=(0,n.useRef)(null),S=(0,n.useRef)([]),v=(0,n.useRef)([]),P=(0,n.useRef)([]),R=(0,n.useRef)([]),M=(0,n.useRef)(!0),x=(0,n.useRef)(null),E=(0,n.useRef)(null),C=(0,n.useRef)(null),z=(0,n.useRef)(new r.YJl),L=(0,n.useRef)(a),T=(0,n.useRef)(0),q=(0,n.useRef)(new r.I9Y),B=(0,n.useRef)(!1),O=(0,n.useRef)(null),H=(0,n.useRef)(w.controls.enableScrollRotation),W=(0,n.useRef)(w.controls.enableScrollImpulse),D=(0,n.useRef)(!1),I=(0,n.useRef)(new r.Pq0);function j(){const e=S.current;e&&e.length&&(v.current=e.map((e=>e.velocity.clone())),P.current=e.map((e=>e.rotationSpeed.clone())),R.current=e.map((e=>e.mass)),e.forEach((e=>{e.mass=0,e.velocity.set(0,0,0),e.rotationSpeed.set(0,0,0)})))}function _(){const e=S.current;if(!e||!e.length)return;M.current=!1,setTimeout((()=>{M.current=!0}),500);const t=I.current||new r.Pq0(0,0,0);e.forEach((e=>{e.mass=1;let o=e.position.clone().sub(t),n=o.length();n<.001&&(o=new r.Pq0(Math.random()-.5,Math.random()-.5,Math.random()-.5),n=o.length()),o.normalize();let i=1/(n+.5);i*=.8+.4*Math.random(),e.velocity.copy(o.multiplyScalar(i));const a=.1+.3*Math.random();e.rotationSpeed.set((Math.random()-.5)*a,(Math.random()-.5)*a,(Math.random()-.5)*a),e.rotation.set(Math.random()*Math.PI*2,Math.random()*Math.PI*2,Math.random()*Math.PI*2)}))}function F(){const e=S.current;null!==e&&void 0!==e&&e.length&&(T.current++,T.current>=L.current.length&&(T.current=0),console.log("\u0417\u0430\u0441\u0442\u043e\u0441\u043e\u0432\u0443\u0454\u0442\u044c\u0441\u044f \u0444\u0456\u0433\u0443\u0440\u0430, state index:",T.current),A())}function Y(){const e=S.current;null!==e&&void 0!==e&&e.length&&(T.current--,T.current<0&&(T.current=L.current.length-1),A())}function A(){const e=S.current,t=T.current,o=L.current;o[t]&&o[t].forEach(((t,o)=>{const{position:n,rotation:i}=t,a=e[o];a.startPos=a.position.clone(),a.startRot=(new r.O9p).copy(a.rotation),a.targetPos=n.clone(),a.targetRot=new r.O9p(i.x,i.y,i.z),a.lerpAlpha=0,a.isLerpingToState=!0}))}return(0,n.useEffect)((()=>{function e(e){const t=e.key.toLowerCase();t===w.controls.toggleKey.toLowerCase()&&(H.current=!H.current,console.log("Scroll rotation toggled:",H.current)),t===w.controls.toggleImpulseKey.toLowerCase()&&(W.current=!W.current,console.log("Scroll impulse toggled:",W.current))}window.addEventListener("keydown",e);const t=new r.Z58;x.current=t;const n=new r.YJl;if(z.current=n,t.add(n),w.debug.enable&&w.debug.showDebugCursorCollision){const e=new r.eaF(new r.Gu$(.05,8,8),new r.V9B({color:w.debug.debugCursorColor,wireframe:!0}));e.visible=!1,t.add(e),O.current=e}const a=new r.ubm(w.camera.fov,y.current.clientWidth/y.current.clientHeight,.1,1e3);a.position.z=5,E.current=a;const{frustumWidth:p,frustumHeight:h}=m(a),v={halfWidth:p/2,halfHeight:h/2,halfDepth:.5};if(w.debug.enable&&w.debug.showDebugSphere){const e=new r.eaF(new r.iNn(2*v.halfWidth,2*v.halfHeight,2*v.halfDepth),new r.V9B({color:16711680,wireframe:!1,transparent:!0,opacity:.2}));e.position.set(0,0,0),t.add(e)}const P=new i.JeP({antialias:w.performance.antialias,alpha:!0,premultipliedAlpha:!1});let R;if(P.setSize(y.current.clientWidth,y.current.clientHeight),P.setPixelRatio(w.performance.pixelRatio),P.shadowMap.enabled=w.performance.enableShadows,P.shadowMap.type=r.Wk7,P.toneMapping=r.FV,P.toneMappingExposure=1,y.current.appendChild(P.domElement),C.current=P,w.performance.enablePostProcessing){R=new c.s(P),b.current=R;const e=new l.A(t,a);if(R.addPass(e),1===P.getPixelRatio()){const e=new u.I(window.innerWidth,window.innerHeight);R.addPass(e)}const o=new d.X;R.addPass(o)}P.physicallyCorrectLights=!0;const L=new i.BdL(P);if(L.compileEquirectangularShader(),o){const e=L.fromEquirectangular(o).texture;t.environment=e,L.dispose()}else(new s.Y).setPath("hdr_maps/").load("poly_haven_studio_1k.hdr",(e=>{const o=L.fromEquirectangular(e).texture;t.environment=o,e.dispose(),L.dispose()}));const T=new r.$p8(16777215,.5);t.add(T);const I=new r.ZyN(16777215,1.5);I.position.set(2,2,2),I.castShadow=w.performance.enableShadows,I.shadow.mapSize.width=2048,I.shadow.mapSize.height=2048,I.shadow.camera.near=.1,I.shadow.camera.far=20,I.shadow.camera.left=-5,I.shadow.camera.right=5,I.shadow.camera.top=5,I.shadow.camera.bottom=-5,t.add(I);function j(e){let{geometry:o,color:i,x:a,y:s,speed:c=.05,rotation:l,isStatic:u=!1}=e;o.computeBoundingSphere();const d=new r.uSd({color:i,metalness:.5,roughness:.3,clearcoat:1,clearcoatRoughness:.1,sheen:.5,transmission:.2,opacity:1,transparent:!0}),p=new r.eaF(o,d);p.castShadow=w.performance.enableShadows,p.receiveShadow=w.performance.enableShadows,u?(p.rotationSpeed=new r.Pq0(0,0,0),p.velocity=new r.Pq0(0,0,0)):(p.rotationSpeed=new r.Pq0((Math.random()-.5)*c*w.speed.objectSpeedMultiplier,(Math.random()-.5)*c*w.speed.objectSpeedMultiplier,(Math.random()-.5)*c*w.speed.objectSpeedMultiplier),p.velocity=new r.Pq0((Math.random()-.5)*c*w.speed.objectSpeedMultiplier,(Math.random()-.5)*c*w.speed.objectSpeedMultiplier,(Math.random()-.5)*c*w.speed.objectSpeedMultiplier)),p.initialVelocity=p.velocity.clone(),p.initialRotationSpeed=p.rotationSpeed.clone(),p.mass=1,p.position.set(a,s,0),p.boundingRadius=o.boundingSphere.radius*w.boundary.sphereScale,p.isLerpingToState=!1,p.lerpAlpha=0,p.startPos=new r.Pq0,p.targetPos=new r.Pq0,p.startRot=new r.O9p,p.targetRot=new r.O9p,l&&p.rotation.copy(l),"OBB"===w.boundary.collisionType&&"CapsuleGeometry"===o.type&&w.debug.enable&&w.debug.showDebugOBB&&(p.obbHelper=f(g(p)),t.add(p.obbHelper)),n.add(p),S.current.push(p)}S.current=[];j({geometry:new r.Gu$(.1,50,50),color:0,x:10*(Math.random()-.5),y:10*(Math.random()-.5),isStatic:!1});for(let o=0;o<5;o++)j({geometry:new r.qU7(.03,.35,50,50),color:0,x:10*(Math.random()-.5),y:10*(Math.random()-.5)});let _=window.scrollY;const F=function(e,t){let o=0;return function(){const n=Date.now();if(!(n-o<t))return o=n,e(...arguments)}}((function(){const e=window.scrollY,t=e-_;_=e,H.current&&z.current&&(z.current.rotation.y=.001*e),W.current&&S.current.forEach((e=>{e.velocity.y+=-2e-4*-t}))}),16);function Y(e){const t=y.current.getBoundingClientRect(),o=new r.I9Y((e.clientX-t.left)/t.width*2-1,-(e.clientY-t.top)/t.height*2+1);q.current.copy(o),B.current=!0}window.addEventListener("scroll",F),window.addEventListener("mousemove",Y);const A=new r.zD7;function k(){a.aspect=y.current.clientWidth/y.current.clientHeight,a.updateProjectionMatrix(),P.setSize(y.current.clientWidth,y.current.clientHeight);const{frustumWidth:e,frustumHeight:t}=m(a);v.halfWidth=e/2,v.halfHeight=t/2}return function e(){requestAnimationFrame(e);const o=A.getDelta();if(S.current.forEach((e=>{e.collisionCount=0})),S.current.forEach((e=>{if(e.isLerpingToState){e.lerpAlpha+=o*w.speed.stateLerpSpeed;const t=Math.min(e.lerpAlpha,1);e.position.lerpVectors(e.startPos,e.targetPos,t);const n=(new r.PTz).setFromEuler(e.startRot),i=(new r.PTz).setFromEuler(e.targetRot),a=(new r.PTz).slerpQuaternions(n,i,t);e.rotation.setFromQuaternion(a),t>=1&&(e.isLerpingToState=!1)}else e.rotation.x+=e.rotationSpeed.x*o,e.rotation.z+=e.rotationSpeed.z*o,e.position.x+=e.velocity.x*o,e.position.y+=e.velocity.y*o,e.position.z+=e.velocity.z*o;const t=e.boundingRadius||0;if(e.position.x+t>v.halfWidth&&(e.position.x=v.halfWidth-t,e.velocity.x*=-1),e.position.x-t<-v.halfWidth&&(e.position.x=-v.halfWidth+t,e.velocity.x*=-1),e.position.y+t>v.halfHeight&&(e.position.y=v.halfHeight-t,e.velocity.y*=-1),e.position.y-t<-v.halfHeight&&(e.position.y=-v.halfHeight+t,e.velocity.y*=-1),e.position.z+t>v.halfDepth&&(e.position.z=v.halfDepth-t,e.velocity.z*=-1),e.position.z-t<-v.halfDepth&&(e.position.z=-v.halfDepth+t,e.velocity.z*=-1),e.obbHelper&&w.debug.enable&&w.debug.showDebugOBB){const t=f(g(e));e.obbHelper.geometry.dispose(),e.obbHelper.geometry=t.geometry}})),B.current&&!D.current){const e=new r.tBo;e.setFromCamera(q.current,E.current);const t=e.ray;let o=!1;S.current.forEach((e=>{const n=new r.iyt(e.position,e.boundingRadius);if(t.intersectsSphere(n)){const n=new r.Pq0;t.closestPointToPoint(e.position,n);if(n.distanceTo(e.position)<e.boundingRadius){const t=(new r.Pq0).subVectors(e.position,n).normalize(),i=w.constants.CURSOR_IMPULSE_MULTIPLIER;e.velocity.add(t.clone().multiplyScalar(i));const a=new r.Pq0(t.y,0,-t.x).multiplyScalar(.5*i);e.rotationSpeed.add(a),e.collisionCount=(e.collisionCount||0)+1,w.debug.enable&&w.debug.showDebugCursorCollision&&O.current&&(O.current.position.copy(n),O.current.visible=!0),o=!0}}})),O.current&&!o&&(O.current.visible=!1)}if(M.current)for(let t=0;t<S.current.length;t++){const e=S.current[t];for(let o=t+1;o<S.current.length;o++){const t=S.current[o];let n=!1;if("OBB"===w.boundary.collisionType){const o=g(e),r=g(t);n=o.intersectsOBB(r)}else if("sphere"===w.boundary.collisionType){n=e.position.distanceTo(t.position)<e.boundingRadius+t.boundingRadius}if(n){const o=.1,n=(new r.Pq0).subVectors(e.position,t.position).normalize().clone().multiplyScalar(o);e.velocity.add(n),t.velocity.sub(n),e.collisionCount=(e.collisionCount||0)+1,t.collisionCount=(t.collisionCount||0)+1}}}S.current.forEach((e=>{const t=.99*(1-Math.min(.05*(e.collisionCount||0),.5)),o=e.velocity.length()*t,n=e.initialVelocity?e.initialVelocity.length():0,r=Math.max(o,n);e.velocity.length()>0&&e.velocity.setLength(r);const i=e.rotationSpeed.length()*t,a=e.initialRotationSpeed?e.initialRotationSpeed.length():0,s=Math.max(i,a);e.rotationSpeed.length()>0&&e.rotationSpeed.setLength(s)})),w.performance.enablePostProcessing&&b.current?b.current.render(o):P.render(t,a)}(),window.addEventListener("resize",k),()=>{window.removeEventListener("resize",k),window.removeEventListener("mousemove",Y),window.removeEventListener("scroll",F),window.removeEventListener("keydown",e),P&&P.dispose(),y.current&&y.current.removeChild(P.domElement),P.dispose()}}),[o]),(0,n.useEffect)((()=>{let e=!1,t=!1,o=null;function n(n){e=!0,M.current=!1;const i=y.current.getBoundingClientRect(),a=new r.I9Y((n.clientX-i.left)/i.width*2-1,-(n.clientY-i.top)/i.height*2+1),s=new r.tBo;s.setFromCamera(a,E.current);const c=new r.Zcv(new r.Pq0(0,0,1),0),l=new r.Pq0;s.ray.intersectPlane(c,l),I.current=l.clone(),D.current=!0,o=setTimeout((()=>{if(e){t=!0;L.current[Math.floor(Math.random()*L.current.length)].forEach(((e,t)=>{const o=S.current[t];o&&(o.startPos=o.position.clone(),o.startRot=(new r.O9p).copy(o.rotation),o.targetPos=e.position.clone().add(I.current),o.targetRot=new r.O9p(e.rotation.x,e.rotation.y,e.rotation.z),o.lerpAlpha=0,o.isLerpingToState=!0)})),j()}}),500)}function i(){e&&(e=!1,o&&(clearTimeout(o),o=null),t?(_(),t=!1):setTimeout((()=>{M.current=!0}),1e3),setTimeout((()=>{D.current=!1}),1e3))}return window.addEventListener("mousedown",n),window.addEventListener("mouseup",i),()=>{window.removeEventListener("mousedown",n),window.removeEventListener("mouseup",i)}}),[]),(0,n.useImperativeHandle)(t,(()=>({stopObjects:j,continueObjects:_,showNextState:F,showPreviousState:Y}))),(0,h.jsx)("div",{ref:y,style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",overflow:"hidden",pointerEvents:"none"}})}))}}]);
//# sourceMappingURL=353.d83528ee.chunk.js.map